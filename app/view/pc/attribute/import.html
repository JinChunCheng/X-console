<div class="panel panel-default m-b-none">
    <form name="importForm" method="post" ng-submit="ok()" novalidate>
        <div class="panel-heading font-bold" ng-bind="importVM.title"></div>
        <div class="panel-body">
            <div class="form-group pull-in clearfix">
                <div class="col-sm-6">
                    <label>下载模板</label>
                    <a href class="form-control btn btn-link" ng-click="downloadTemplet();" target="_blank">
                        下载产品属性导入模板
                    </a>
                </div>
                <div class="col-sm-6">
                    <label>上传文件</label>
                    <input id="file" valid-file ng-model="importVM.file" class="form-control" required name="file" type="file" ng-change="fileChange()" />
                </div>
            </div>
            <div class="form-group pull-in m-b-xs clearfix" ng-if="importVM.importMessage" ng-cloak>
                <div class="col-sm-12">
                    <span ng-bind="importVM.importMessage" class="text-danger"></span>
                </div>
            </div>
            <div class="form-group pull-in clearfix" ng-if="importVM.excelErrors.length>0" ng-cloak>
                <div class="col-sm-12">
                    <table class="table table-striped m-b-none">
                        <thead>
                            <tr>
                                <th>错误行</th>
                                <th>字段</th>
                                <th>错误原因</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="excelError in importVM.excelErrors">
                                <th>{{excelError.errorRow}}</th>
                                <th>{{excelError.errorField}}</th>
                                <th>{{excelError.errorMsg}}</th>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="panel-footer text-right">
            <button type="submit" class="btn btn-primary" ng-disabled="importVM.saving||importForm.$invalid">
                <span class="w2em" ng-if="!importVM.saving" ng-cloak>导入</span>
                <i class="fa fa-spin fa-spinner w2em" ng-if="importVM.saving" ng-cloak></i>
            </button>
            <button type="button" class="btn btn-default m-l-xs" ng-click="cancel()">
                关闭
            </button>
        </div>
    </form>
</div>
